<template>
  <div class="components-item">
    <div class="components-item-header">全网业务量变化态势</div>
    <div class="components-item-body" ref="echart"></div>
  </div>
</template>

<script>
import {
  title,
  tooltip,
  axisLabel,
  axisLine,
  axisTick,
  splitLine
} from "../echarts.json";
export default {
  name: "TrendPrediction",
  data() {
    return {};
  },
  methods: {
    draw() {
      var dataMap = {};
      function dataFormatter(obj) {
        var pList = [
          "北京",
          "天津",
          "河北",
          "山西",
          "内蒙古",
          "辽宁",
          "吉林",
          "黑龙江",
          "上海",
          "江苏",
          "浙江",
          "安徽",
          "福建",
          "江西",
          "山东",
          "河南",
          "湖北",
          "湖南",
          "广东",
          "广西",
          "海南",
          "重庆",
          "四川",
          "贵州",
          "云南",
          "西藏",
          "陕西",
          "甘肃",
          "青海",
          "宁夏",
          "新疆"
        ];
        var temp;
        for (var year = 2002; year <= 2011; year++) {
          var max = 0;
          var sum = 0;
          temp = obj[year];
          for (var i = 0, l = temp.length; i < l; i++) {
            max = Math.max(max, temp[i]);
            sum += temp[i];
            obj[year][i] = {
              name: pList[i],
              value: temp[i]
            };
          }
          obj[year + "max"] = Math.floor(max / 100) * 100;
          obj[year + "sum"] = sum;
        }
        return obj;
      }

      dataMap.dataGDP = dataFormatter({
        //max : 60000,
        2011: [
          6251.93,
          1307.28,
          4515.76,
          1237.55,
          4359.88,
          2226.7,
          1568.83,
          2582,
          9195.69,
          9110.27,
          2318.85,
          5300.65,
          7560.18,
          1702.82,
          5361.85,
          6931.03,
          9632.26,
          9669.56,
          3210.28,
          1720.87,
          2522.66,
          1001.37,
          2102.68,
          5701.84,
          889.12,
          605.83,
          1251.3,
          5020.37,
          1670.44,
          2102.21,
          6610.05
        ],
        2010: [
          1411.58,
          9224.46,
          2039.26,
          9200.86,
          1167,
          1845.27,
          8667.58,
          1036.6,
          1716.98,
          4142.48,
          2772.31,
          1235.33,
          1473.12,
          9451.26,
          3916.92,
          2309.36,
          1596.61,
          1603.96,
          4601.06,
          9569.85,
          2064.5,
          7925.58,
          1718.48,
          4602.16,
          7224.18,
          507.46,
          1012.48,
          4120.75,
          1350.43,
          1689.65,
          5437.47
        ],
        2009: [
          1215.03,
          7521.85,
          1723.48,
          7358.31,
          9740.25,
          1521.49,
          7278.75,
          8587,
          1504.45,
          3445.3,
          2299.35,
          1006.82,
          1223.53,
          7655.18,
          3389.65,
          1948.46,
          1296.1,
          1305.69,
          3948.56,
          7759.16,
          1654.21,
          6530.01,
          1415.28,
          3912.68,
          6169.75,
          441.36,
          8169.8,
          3387.56,
          1081.27,
          1353.31,
          4277.05
        ],
        2008: [
          1115,
          6719.01,
          1611.97,
          7315.4,
          8496.2,
          1368.58,
          6426.1,
          8314.37,
          1406.87,
          3098.98,
          2146.69,
          8851.66,
          1082.01,
          6971.05,
          3093.28,
          1801.53,
          1132.92,
          1155,
          3679.71,
          7021,
          1503.06,
          5793.66,
          1260.23,
          3561.56,
          5692.12,
          394.85,
          7314.58,
          3166.82,
          1018.62,
          1203.92,
          4183.21
        ],
        2007: [
          9846.81,
          5252.76,
          1360.32,
          6024.45,
          6423.18,
          1116.3,
          5284.69,
          7104,
          1249.01,
          2601.48,
          1875.73,
          7360.92,
          9248.53,
          5800.25,
          2577.91,
          1501.46,
          9333.4,
          9439.6,
          3177.01,
          5823.41,
          1254.17,
          4676.13,
          1056.39,
          2884.11,
          4772.52,
          1341.43,
          5757.29,
          2703.98,
          797.35,
          1919.11,
          3523.16
        ],
        2006: [
          8117.78,
          4462.74,
          1147.6,
          4878.61,
          4944.25,
          9304.52,
          4275.12,
          6211.8,
          1072.24,
          2174.05,
          1571.47,
          6112.5,
          7583.85,
          4820.53,
          2190.19,
          1236.79,
          7617.47,
          7688.67,
          2658.76,
          4746.16,
          1065.67,
          3907.23,
          8690.24,
          2338.98,
          3988.14,
          1290.76,
          4743.61,
          2277.35,
          1648.5,
          1725.9,
          3045.26
        ],
        2005: [
          6969.52,
          3905.64,
          1001.11,
          4230.53,
          3905.03,
          8047.26,
          3620.27,
          5513.7,
          9247.66,
          1859.69,
          13417.68,
          5350.17,
          6554.69,
          4056.76,
          1836.87,
          1058.42,
          6590.19,
          6596.1,
          2257.37,
          3984.1,
          1918.75,
          3467.72,
          7385.1,
          2005.42,
          3462.73,
          1248.8,
          3933.72,
          1933.98,
          1543.32,
          1612.61,
          2604.19
        ],
        2004: [
          6033.21,
          3110.97,
          8477.63,
          3571.37,
          3041.07,
          6672,
          3122.01,
          4750.6,
          8072.83,
          1500.6,
          1164.7,
          4759.3,
          5763.35,
          3456.7,
          1502.84,
          8553.79,
          5633.24,
          5641.94,
          1886.62,
          3433.5,
          819.66,
          3034.58,
          6379.63,
          1677.8,
          3081.91,
          1220.34,
          3175.58,
          1688.49,
          1466.1,
          1537.11,
          2209.09
        ],
        2003: [
          5007.21,
          2578.03,
          6921.29,
          2855.23,
          2388.38,
          6002.54,
          2662.08,
          4057.4,
          6694.23,
          1242.87,
          9705.02,
          3923.11,
          4983.67,
          2807.41,
          1278.15,
          6867.7,
          4757.45,
          4659.99,
          1544.64,
          2821.11,
          1713.96,
          2555.72,
          5333.09,
          1426.34,
          2556.02,
          1185.09,
          2587.72,
          1399.83,
          1390.2,
          1445.36,
          1886.35
        ],
        2002: [
          4315,
          2150.76,
          6018.28,
          2324.8,
          1940.94,
          5458.22,
          2348.54,
          3637.2,
          5741.03,
          1066.85,
          8003.67,
          3519.72,
          4467.55,
          2450.48,
          1027.5,
          6035.48,
          4212.82,
          4151.54,
          1350.42,
          2523.73,
          1642.73,
          2232.86,
          4725.01,
          1243.43,
          2312.82,
          1162.04,
          2253.39,
          1232.03,
          1340.65,
          1377.16,
          1612.6
        ]
      });
      dataMap.dataFinancial = dataFormatter({
        //max : 3200,
        2011: [
          2215.41,
          7516.5,
          7426.01,
          5219.32,
          4247.46,
          7255.57,
          2207.65,
          3270.78,
          2277.4,
          2600.11,
          2730.29,
          5203.85,
          8262.41,
          3257.44,
          1640.41,
          8268.2,
          6274.57,
          5201.09,
          2916.13,
          4245.37,
          1205.24,
          7204.66,
          8268.15,
          2297.27,
          4256.23,
          3221.7,
          4322.11,
          8145.05,
          6882.56,
          8134.18,
          8288.77
        ],
        2010: [
          1863.61,
          8572.99,
          8615.42,
          8448.3,
          8346.44,
          8639.27,
          8190.12,
          8304.59,
          1950.96,
          2105.92,
          2326.58,
          8396.17,
          8767.58,
          8241.49,
          1361.45,
          8697.68,
          8561.27,
          8463.16,
          2658.76,
          8384.53,
          8878.12,
          8496.56,
          8654.7,
          8231.51,
          8375.08,
          8827.08,
          3884.75,
          1800.54,
          8584.53,
          8897.87,
          8225.2
        ],
        2009: [
          1603.63,
          4861.2,
          5825.67,
          3861.64,
          2891.1,
          5860.2,
          1880.83,
          2827.54,
          1804.28,
          1596.98,
          1899.33,
          3859.6,
          6812.2,
          1685.1,
          1044.9,
          4989.92,
          4789.11,
          4082.57,
          2283.29,
          3386.82,
          6588.73,
          3898.97,
          5248.63,
          1948.44,
          3518.74,
          2388.17,
          3368.21,
          8888.27,
          4588.63,
          7588.54,
          1988.87
        ],
        2008: [
          1519.19,
          3688.1,
          4208.74,
          2908.91,
          2198.09,
          4558.07,
          1478.24,
          1778.43,
          1414.21,
          1298.48,
          1653.45,
          3138.81,
          4978.65,
          1308.57,
          8808.28,
          4813.83,
          3893.05,
          3834.32,
          1972.4,
          2849.01,
          4887.33,
          3083.01,
          4181.14,
          1581.55,
          2787.66,
          2288.42,
          2887.16,
          7288.49,
          3886.54,
          6884.8,
          1881.97
        ],
        2007: [
          1302.77,
          5288.17,
          3447.65,
          2718.73,
          1748.3,
          3786.34,
          7126.03,
          7155.48,
          1209.08,
          1054.25,
          1251.43,
          7223.85,
          7385.84,
          7101.34,
          7734.9,
          7302.31,
          7337.27,
          7260.14,
          1705.08,
          7190.73,
          7734.43,
          7247.46,
          7359.11,
          7122.25,
          7168.55,
          7711.51,
          8231.03,
          8861.6,
          8827.67,
          8851.05,
          8149.22
        ],
        2006: [
          8982.37,
          8186.87,
          8284.04,
          8169.63,
          8108.21,
          8303.41,
          8100.75,
          8874.17,
          8825.2,
          8653.25,
          8906.37,
          8166.01,
          8243.9,
          879.75,
          8524.94,
          8219.72,
          8174.99,
          8204.72,
          8899.91,
          8129.14,
          8816.37,
          8213.7,
          2899.5,
          8889.43,
          1483.62,
          6888.44,
          1528.25,
          5880.51,
          2883.69,
          3886.99,
          9889.25
        ],
        2005: [
          8480.2,
          1487.4,
          2183.47,
          1385.07,
          7288.52,
          2328.85,
          8388.63,
          3588.03,
          6758.12,
          4928.4,
          6868.32,
          1278.05,
          1868.12,
          6988.55,
          4488.36,
          1818.74,
          1278.32,
          1628.37,
          6618.81,
          9188.93,
          1388.16,
          1858.18,
          2628.26,
          7388.67,
          1308.5,
          7888.57,
          1278.58,
          4488.73,
          2088.36,
          3288.25,
          8088.34
        ],
        2004: [
          7138.79,
          1368.97,
          2098.1,
          1108.29,
          5588.89,
          1888.04,
          7788.17,
          3288.2,
          6128.45,
          4408.5,
          5238.49,
          9488.1,
          1718,
          6588.1,
          3438.37,
          1708.82,
          1188.85,
          1188.64,
          6028.68,
          7488,
          1188.56,
          1628.38,
          2368.5,
          6088.3,
          1188.4,
          5888.4,
          9088.1,
          4288.99,
          1889,
          2788.92,
          7088.3
        ],
        2003: [
          8635.56,
          1812.79,
          1989.87,
          1818.48,
          5885.89,
          1485.38,
          7388.15,
          3288.2,
          5187.97,
          3982.11,
          4581.54,
          8788.45,
          1508.09,
          6488.31,
          3298.71,
          1658.11,
          1078.31,
          9988.35,
          5348.28,
          6188.59,
          1088.68,
          1478.04,
          2068.24,
          4888.01,
          1058.48,
          4888.74,
          7788.87,
          4882.31,
          1887.98,
          2884.8,
          684.92
        ],
        2002: [
          2561.91,
          7226.86,
          12279.6,
          1324.1,
          4238.39,
          1337.18,
          7335.45,
          3231.6,
          4285.25,
          3628.86,
          3247.53,
          8221.85,
          1238.28,
          7226.51,
          3210.07,
          1528.77,
          9236.95,
          2392.43,
          4254.65,
          3235.86,
          1230.08,
          1234.52,
          1283.13,
          4231.45,
          1202.39,
          2234.81,
          6237.3,
          4232.08,
          1236.75,
          2231.45,
          5232.18
        ]
      });
      if (!this.myChart) {
        const myChart = this.$echarts.init(this.$refs.echart);
        this.myChart = window.BusinessStatistics_myChart = myChart;
      }
      this.myChart.setOption({
        baseOption: {
          timeline: {
            // y: 0,
            axisType: "category",
            // realtime: false,
            // loop: false,
            autoPlay: true,
            // currentIndex: 2,
            playInterval: 6000,
            // controlStyle: {
            //     position: 'left'
            // },
            lineStyle: {
              color: "#04649e"
            },
            data: [
              "2002-01-01",
              "2003-01-01",
              "2004-01-01",
              "2005-01-01",
              "2006-01-01",
              "2007-01-01",
              "2008-01-01",
              "2009-01-01",
              "2010-01-01",
              "2011-01-01"
            ],
            label: {
              color: "#9fcfe3",
              formatter: function(s) {
                return new Date(s).getFullYear();
              }
            },
            itemStyle: {
              normal: {
                color: "#04649e"
              },
              emphasis: {
                color: "#fdffb6"
              }
            },
            checkpointStyle: {
              color: "#04649e",
              borderColor: "transparent"
            },
            controlStyle: {
              color: "#9fcfe3"
            }
          },
          title: {
            show: false
          },
          tooltip: {},
          grid: {
            top: 24,
            bottom: 100,
            tooltip: {
              trigger: "axis",
              axisPointer: {
                type: "shadow",
                label: {
                  show: true,
                  formatter: function(params) {
                    return params.value.replace("\n", "");
                  }
                }
              }
            }
          },
          xAxis: [
            {
              type: "category",
              data: [
                "北京",
                "\n天津",
                "河北",
                "\n山西",
                "内蒙古",
                "\n辽宁",
                "吉林",
                "\n黑龙江",
                "上海",
                "\n江苏",
                "浙江",
                "\n安徽",
                "福建",
                "\n江西",
                "山东",
                "\n河南",
                "湖北",
                "\n湖南",
                "广东",
                "\n广西",
                "海南",
                "\n重庆",
                "四川",
                "\n贵州",
                "云南",
                "\n西藏",
                "陕西",
                "\n甘肃",
                "青海",
                "\n宁夏",
                "新疆"
              ],
              splitLine: { show: false },
              axisLabel: {
                interval: 0,
                rotate: 45,
                textStyle: {
                  color: "#fff"
                }
              },
              axisLine: {
                lineStyle: {
                  color: "#04649e"
                }
              }
            }
          ],
          yAxis: [
            {
              type: "value",
              axisLabel: {
                textStyle: {
                  color: "#fff"
                }
              },
              axisLine: {
                lineStyle: {
                  color: "#04649e"
                }
              },
              splitLine: {
                lineStyle: {
                  color: ["rgba(14, 137, 212, .15)"]
                }
              },
              axisTick: {
                show: false
              }
            }
          ],
          series: [
            { name: "数据库交换量", type: "bar" },
            { name: "API服务次数", type: "bar" }
          ],
          color: ["#02bdce", "#71c049"]
        },
        options: [
          {
            title: { text: "2002全国宏观经济指标" },
            series: [
              { data: dataMap.dataGDP["2002"] },
              { data: dataMap.dataFinancial["2002"] }
            ]
          },
          {
            title: { text: "2003全国宏观经济指标" },
            series: [
              { data: dataMap.dataGDP["2003"] },
              { data: dataMap.dataFinancial["2003"] }
            ]
          },
          {
            title: { text: "2004全国宏观经济指标" },
            series: [
              { data: dataMap.dataGDP["2004"] },
              { data: dataMap.dataFinancial["2004"] }
            ]
          },
          {
            title: { text: "2005全国宏观经济指标" },
            series: [
              { data: dataMap.dataGDP["2005"] },
              { data: dataMap.dataFinancial["2005"] }
            ]
          },
          {
            title: { text: "2006全国宏观经济指标" },
            series: [
              { data: dataMap.dataGDP["2006"] },
              { data: dataMap.dataFinancial["2006"] }
            ]
          },
          {
            title: { text: "2007全国宏观经济指标" },
            series: [
              { data: dataMap.dataGDP["2007"] },
              { data: dataMap.dataFinancial["2007"] }
            ]
          },
          {
            title: { text: "2008全国宏观经济指标" },
            series: [
              { data: dataMap.dataGDP["2008"] },
              { data: dataMap.dataFinancial["2008"] }
            ]
          },
          {
            title: { text: "2009全国宏观经济指标" },
            series: [
              { data: dataMap.dataGDP["2009"] },
              { data: dataMap.dataFinancial["2009"] }
            ]
          },
          {
            title: { text: "2010全国宏观经济指标" },
            series: [
              { data: dataMap.dataGDP["2010"] },
              { data: dataMap.dataFinancial["2010"] }
            ]
          },
          {
            title: { text: "2011全国宏观经济指标" },
            series: [
              { data: dataMap.dataGDP["2011"] },
              { data: dataMap.dataFinancial["2011"] }
            ]
          }
        ]
      });
    }
  },
  created() {
    this.$nextTick(() => {
      this.draw();
    });
  }
};
</script>